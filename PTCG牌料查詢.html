<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BenMao の PTCG 牌料</title>

    <!-- 連結Bootstrap -->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>


    <script>
        //  避免表單有空白的錯誤

        function preventFormSubmit() {
            var forms = document.querySelectorAll('form');
            for (var i = 0; i < forms.length; i++) {
                forms[i].addEventListener('submit', function(event) {
                    event.preventDefault();
                });
            }

        }
        window.addEventListener("load", preventFormSubmit, true);

        // 顯示表格內容

        function createTable(dataArray) {
            if (dataArray && dataArray !== undefined && dataArray.length != 0) {

                var result = "<table class='table table-sm table-striped' id='dtable' style='font-size:30px'>" +
                    "<thead style='white-space: nowrap'>" +
                    "<tr>" + //Change table headings to match witht he Google Sheet
                    "<th scope='col'>卡片類別</th>" +
                    "<th scope='col'>卡片屬性</th>" +
                    "<th scope='col'>卡片名稱</th>" +
                    "<th scope='col'>卡片編號</th>" +
                    "<th scope='col'>等級</th>" +
                    "<th scope='col'>數量</th>" +
                    "<th scope='col'>價格</th>" +


                    "</tr>" +
                    "</thead>";
                for (var i = 0; i < dataArray.length; i++) {
                    result += "<tr>";
                    for (var j = 0; j < dataArray[i].length; j++) {
                        result += "<td>" + dataArray[i][j] + "</td>";
                    }
                    result += "</tr>";
                }
                result += "</table>";
                var div = document.getElementById('search-results');
                div.innerHTML = result;


            } else {

                var div = document.getElementById('search-results');
                div.innerHTML = "沒有找到資料!";
            }
        }

        // 連結Google Script　並且顯示資料

        function handleFormSubmit(formObject) {
            google.script.run.withSuccessHandler(createTable).submitForm(formObject);
            document.getElementById("search-form").reset();
        }
    </script>

</head>

<body>

    <br>
    <br>
    <!--搜尋表單  -->

    <div class="container">

        <div class="row">

            <h1><b><font color = #0000FF>BenMao の PTCG 牌料</font></b></h1>
            <br>
            <br>
            <form id="search-form" class="form-inline" onsubmit="handleFormSubmit(this)">
                <br>
                <h2>請輸入你想查詢的卡片</h2>
                <h2>目前支援 5 種方式</h2>
                <br>

                <h2><b><font color = #ff0000>卡片種類:</font></b></h2>               
                <h3>寶可夢、物品、支援者、場地</h3>
                <br>
                <h2><b><font color = #fc6603>卡片屬性:</font></b></h2>
                <h3>水、火、草、電、超能、無、格鬥、鋼、惡</h3>
                <br>
                <h2><b><font color = #dec718>卡片名稱</font></b></h2>
                <br>
                <h2><b><font color = #0f7000>卡片編號</font></b></h2>
                <br>
                <h2><b><font color = #0051b5>卡片等級:</font></b></h2>
                <h3>C、U、R、RR、RRR、SR、HR、UR、K、CHR、CSR</h3>
                <br>
                <h3>可輸入的資料範例如上</h3>
                <h3>並選擇一種即可!</h3>
                <br>
                <h3>比如可以搜尋:</h3>
                <h3>"寶可夢"、"草"、"葉伊布"、"F標-S10DF-3/67"、"U"...</h3>
                <br>
                <input style="width:100%;height:50px;font-size:30px;text-align: center;" type="text" id="searchtext" name="searchtext" placeholder="請輸入想查詢的內容">
                <br>
                <button style="width:100%;font-size:30px;" type="submit" class="btn btn-primary">點我搜尋</button>
                <br>
                <br>
            </form>


        </div>

        <!-- 表格要顯示的地方 -->
        <div class="row">
            <br>
            <div id="search-results" class="table-reponsive">


            </div>

        </div>


    </div>


</body>

</html>


